(function(){this.SimpleVast=function(){function a(a){var b,c,d,e,f,g,h,i,j,k,l,m,n;return h="simple VAST",a?(a.dbg&&console.log(""+h+": inited!"),n=this,l=0,m={adTitle:null,impression:null,videoUrl:"",duration:null,customViewTracker:null,clickUrl:null,trackers:[]},d=["firstQuartile","midpoint","thirdQuartile","complete","mute","unmute","rewind","pause","resume","fullscreen","creativeView","acceptInvitation","start","complete"],this.getAd=function(a){return n.completeCallback=a,k(),g()},g=function(){var b;return b=f(),b?(a.dbg&&console.log(""+h+": try get tag â„–"+l+" "+b.url),e(b.url,function(){return function(a){var c;return a?(c=j(b,a),c?n.completeCallback(c):g()):g()}}(this))):n.completeCallback(null)},j=function(d,e){var f,g;switch(a.dbg&&console.log(""+h+": search parser for "+d.provider),d.provider.toLowerCase()){case"adfox":g=b;break;case"openx":g=i;break;case"dfp":g=c;break;default:a.dbg&&console.log(""+h+": unknown parser for "+d.provider)}return f=g(e)},f=function(){return a.dbg&&console.log("............ \n"+h+": check if tag exists"),l++,a.vastTags[l-1]?a.vastTags[l-1]:(a.dbg&&console.log(""+h+": no more tags"),!1)},k=function(){return m={adTitle:null,impression:null,videoUrl:"",duration:null,customViewTracker:null,trackers:[]}},c=function(b){var c,e,f,g,i,j,k,l,n;a.dbg&&console.log(""+h+": try parse dfpParser node");try{if(!b.querySelector("Ad"))return a.dbg&&console.log(""+h+": VAST response is empty"),!1;for(i=b.querySelector("TrackingEvents"),m.adTitle=b.querySelector("AdTitle").childNodes[0]?b.querySelector("AdTitle").childNodes[0].data:null,m.impression=b.querySelector("Impression").childNodes[0]?b.querySelector("Impression").childNodes[0].data:null,m.videoUrl=b.querySelector("MediaFiles>MediaFile").childNodes[0]?b.querySelector("MediaFiles>MediaFile").childNodes[0].data:null,m.duration=b.querySelector("Creative Duration").innerHTML?b.querySelector("Creative Duration").innerHTML:null,m.customViewTracker=b.querySelector("#secondaryAdServer")?b.querySelector("#secondaryAdServer").childNodes[0].data:null,m.clickUrl=b.querySelector("VideoClicks ClickThrough")?b.querySelector("VideoClicks ClickThrough").childNodes[0].data:null,j=0,l=d.length;l>j;j++)for(g=d[j],f=i.querySelectorAll("[event='"+g+"']"),k=0,n=f.length;n>k;k++)e=f[k],m.trackers[g]||(m.trackers[g]=[]),m.trackers[g].push(e.childNodes[0].data);return m}catch(o){return c=o,a.dbg&&console.error(""+h+": parser crashed!"),console.log(c)}},i=function(b){var c,e,f,g,i,j;a.dbg&&console.log(""+h+": try parse openxParser node");try{if(!b.querySelector("Ad"))return a.dbg&&console.log(""+h+": VAST response is empty"),!1;for(g=b.querySelector("TrackingEvents"),m.adTitle=b.querySelector("AdTitle").childNodes[0].data,m.impression=b.querySelector("#primaryAdServer").childNodes[0].data,m.videoUrl=b.querySelector("MediaFile>URL").childNodes[0].data,m.duration=b.querySelector("Video>Duration").innerHTML,m.customViewTracker=b.querySelector("#secondaryAdServer")?b.querySelector("#secondaryAdServer").childNodes[0].data:null,i=0,j=d.length;j>i;i++)f=d[i],e=g.querySelector("[event='"+f+"']"),e&&e.querySelector&&(m.trackers[f]=[e.querySelector("URL").childNodes[0].data],"start"===d[f]&&m.customViewTracker&&m.trackers[f].push(m.customViewTracker));return m}catch(k){if(c=k,a.dbg)return console.error(""+h+": parser crashed!")}},b=function(b){var c,e,f,g,i,j,k,l,n;a.dbg&&console.log(""+h+": try parse adfoxXML node");try{if(!b.querySelector("Ad"))return a.dbg&&console.log(""+h+": VAST response is empty"),!1;for(i=b.querySelector("TrackingEvents"),m.adTitle=b.querySelector("AdTitle").childNodes[0]?b.querySelector("AdTitle").childNodes[0]:"no title",m.impression=b.querySelector("Impression").childNodes[0].data,m.videoUrl=b.querySelector("MediaFile").childNodes[0].data,m.duration=b.querySelector("Duration").innerHTML,m.customViewTracker=b.querySelector("#secondaryAdServer")?b.querySelector("#secondaryAdServer").childNodes[0].data:null,j=0,l=d.length;l>j;j++)for(g=d[j],f=i.querySelectorAll("[event='"+g+"']"),k=0,n=f.length;n>k;k++)e=f[k],m.trackers[g]||(m.trackers[g]=[]),m.trackers[g].push(e.childNodes[0].data);return m}catch(o){if(c=o,a.dbg)return console.error(""+h+": parser crashed!")}},void(e=function(b,c){var d;return d=new XMLHttpRequest,d.open("GET",b,!0),d.onreadystatechange=function(){var b;if(4===d.readyState){if(200!==d.status)return a.dbg&&console.log(""+h+": response error"),c(null);try{return c(this.responseXML.documentElement)}catch(e){return b=e,a.dbg&&console.log(""+h+": unknown response"),c(null)}}},d.send()})):(console.log(""+h+" options undefined!"),!1)}return a}()}).call(this);